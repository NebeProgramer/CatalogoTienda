<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Configuración del Indicador de Tema - Catálogo Tienda</title>
    <link rel="stylesheet" href="/css/style.css">
    <style>
        .demo-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        .control-section {
            background: var(--bg-tertiary);
            border: 2px solid var(--border-primary);
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        .btn {
            background: linear-gradient(135deg, var(--bg-secondary), var(--text-accent));
            color: var(--text-primary);
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            font-weight: bold;
            cursor: pointer;
            margin: 5px;
            transition: all 0.3s ease;
        }
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }
        .btn-danger {
            background: linear-gradient(135deg, var(--error), #c53030);
            color: white;
        }
        .btn-success {
            background: linear-gradient(135deg, var(--success), #38a169);
            color: white;
        }
        .info-box {
            background: var(--bg-primary);
            border: 1px solid var(--border-primary);
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        .theme-indicator-preview {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: var(--bg-secondary);
            color: var(--text-primary);
            padding: 8px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            border: 2px solid var(--border-primary);
            z-index: 1000;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .status-indicator {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 8px;
        }
        .status-visible {
            background-color: var(--success);
        }
        .status-hidden {
            background-color: var(--error);
        }
    </style>
</head>
<body>
    <div class="demo-container">
        <h1>🎛️ Configuración del Indicador de Tema</h1>
        <p>Controla la visibilidad del indicador de tema que aparece en la esquina inferior derecha de la pantalla.</p>

        <div class="info-box">
            <h2>📍 ¿Qué es el Indicador de Tema?</h2>
            <p>El indicador de tema es un pequeño widget que muestra el nombre y icono del tema actualmente aplicado. Aparece en la esquina inferior derecha y permite acceso rápido a las preferencias de tema.</p>
            
            <p><strong>Características:</strong></p>
            <ul>
                <li>✅ Muestra el nombre del tema dinámico actual (no el ID)</li>
                <li>✅ Incluye el icono personalizado del tema</li>
                <li>✅ Es clickeable para abrir preferencias</li>
                <li>✅ Se puede ocultar completamente si no lo necesitas</li>
                <li>✅ Recuerda tu preferencia entre sesiones</li>
            </ul>
        </div>

        <div class="control-section">
            <h2>🎛️ Controles de Visibilidad</h2>
            
            <div style="margin-bottom: 20px;">
                <h3>Estado Actual:</h3>
                <span id="status-indicator" class="status-indicator status-visible"></span>
                <span id="status-text">Indicador Visible</span>
            </div>

            <div>
                <button class="btn btn-success" onclick="mostrarIndicador()">
                    👁️ Mostrar Indicador
                </button>
                <button class="btn btn-danger" onclick="ocultarIndicador()">
                    🙈 Ocultar Indicador
                </button>
                <button class="btn" onclick="toggleIndicador()">
                    🔄 Alternar Visibilidad
                </button>
            </div>
        </div>

        <div class="control-section">
            <h2>🧪 Funciones de Prueba</h2>
            <p>Estas funciones te permiten probar el comportamiento del indicador:</p>
            
            <button class="btn" onclick="actualizarIndicador()">
                🔄 Actualizar Indicador
            </button>
            <button class="btn" onclick="mostrarInformacionTema()">
                ℹ️ Mostrar Info del Tema
            </button>
            <button class="btn" onclick="irAPreferencias()">
                ⚙️ Abrir Preferencias
            </button>
        </div>

        <div class="info-box">
            <h2>💡 Instrucciones de Uso</h2>
            <ol>
                <li><strong>Para ocultar:</strong> Haz clic en "Ocultar Indicador" - el widget desaparecerá inmediatamente</li>
                <li><strong>Para mostrar:</strong> Haz clic en "Mostrar Indicador" - el widget reaparecerá en su posición</li>
                <li><strong>Preferencia persistente:</strong> Tu elección se guarda automáticamente y se aplicará en futuras visitas</li>
                <li><strong>Acceso a preferencias:</strong> Si el indicador está visible, puedes hacer clic en él para abrir las preferencias de tema</li>
            </ol>
            
            <p><strong>Nota:</strong> Si ocultaste el indicador y quieres acceder a las preferencias, puedes usar el botón "Abrir Preferencias" en esta página o buscar el botón de preferencias en la barra de navegación.</p>
        </div>

        <div class="control-section">
            <h2>🔧 Funciones JavaScript Disponibles</h2>
            <p>Para desarrolladores - estas funciones están disponibles globalmente:</p>
            
            <div style="background: #f4f4f4; padding: 15px; border-radius: 6px; font-family: monospace; font-size: 14px;">
                <div>🔹 <strong>window.ocultarIndicadorTema()</strong> - Oculta el indicador</div>
                <div>🔹 <strong>window.mostrarIndicadorTema()</strong> - Muestra el indicador</div>
                <div>🔹 <strong>window.toggleIndicadorTema()</strong> - Alterna la visibilidad</div>
                <div>🔹 <strong>window.temasManager.actualizarIndicadorTema()</strong> - Actualiza el contenido</div>
            </div>
        </div>
    </div>

    <!-- Scripts necesarios -->
    <script src="/js/temasManager.js"></script>
    <script src="/js/editor-temas.js"></script>
    
    <script>
        // Funciones para los controles de la página
        function mostrarIndicador() {
            window.mostrarIndicadorTema();
            actualizarEstado();
            console.log('✅ Indicador de tema mostrado');
        }
        
        function ocultarIndicador() {
            window.ocultarIndicadorTema();
            actualizarEstado();
            console.log('❌ Indicador de tema oculto');
        }
        
        function toggleIndicador() {
            window.toggleIndicadorTema();
            actualizarEstado();
            console.log('🔄 Visibilidad del indicador alternada');
        }
        
        function actualizarIndicador() {
            if (window.temasManager && typeof window.temasManager.actualizarIndicadorTema === 'function') {
                window.temasManager.actualizarIndicadorTema();
                console.log('🔄 Indicador actualizado');
            } else {
                console.log('❌ No se pudo actualizar el indicador');
            }
        }
        
        function mostrarInformacionTema() {
            if (typeof window.obtenerTemaActual === 'function') {
                const tema = window.obtenerTemaActual();
                if (tema) {
                    alert(`📋 Tema Actual:\n\n🎨 Nombre: ${tema.nombre}\n📛 ID: ${tema.id}\n🎭 Icono: ${tema.icono}\n✅ Aplicado: ${tema.aplicado ? 'Sí' : 'No'}`);
                } else {
                    alert('⚠️ No hay tema dinámico aplicado');
                }
            } else {
                alert('❌ Función obtenerTemaActual no disponible');
            }
        }
        
        function irAPreferencias() {
            const btnPreferencias = document.getElementById('btnPreferencias');
            if (btnPreferencias) {
                btnPreferencias.click();
            } else {
                alert('⚠️ No se encontró el botón de preferencias en esta página.\n\nPuedes acceder a las preferencias desde la barra de navegación.');
            }
        }
        
        function actualizarEstado() {
            setTimeout(() => {
                const indicador = document.getElementById('theme-indicator');
                const statusIndicator = document.getElementById('status-indicator');
                const statusText = document.getElementById('status-text');
                
                const estaVisible = indicador && indicador.style.display !== 'none';
                
                if (estaVisible) {
                    statusIndicator.className = 'status-indicator status-visible';
                    statusText.textContent = 'Indicador Visible';
                } else {
                    statusIndicator.className = 'status-indicator status-hidden';
                    statusText.textContent = 'Indicador Oculto';
                }
            }, 100);
        }
        
        // Actualizar estado inicial
        document.addEventListener('DOMContentLoaded', () => {
            setTimeout(actualizarEstado, 500);
        });
        
        // Observar cambios en el DOM para actualizar el estado
        const observer = new MutationObserver(actualizarEstado);
        if (document.body) {
            observer.observe(document.body, { 
                childList: true, 
                subtree: true, 
                attributes: true, 
                attributeFilter: ['style'] 
            });
        }
    </script>
</body>
</html>
